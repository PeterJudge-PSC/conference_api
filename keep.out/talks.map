{
  "services": {
    "talks": {
      "version": "1.0.0",
      "operations": {
        "/": {
          "GET": {
            "contentType": "application/vnd.conf.talks+json",
            "statusCode": 200,
            "entity": {
              "type": "procedure",
              "name": "logic/talk/read_talks.p",
              "function": "get_filtered_talks",
              "arg": [
                {
                  "ablName": "pFilter",
                  "ablType": "CHARACTER",
                  "ioMode": "INPUT",
                  "msgElem": {"type": "QUERY", "name": "filter" }
                },
                {
                  "ablName": "pSkipRecs",
                  "ablType": "INTEGER",
                  "ioMode": "INPUT",
                  "msgElem": {"type": "QUERY","name": "skip"}
                },
                {
                  "ablName": "pTopRecs",
                  "ablType": "INTEGER",
                  "ioMode": "INPUT",
                  "msgElem": {"type": "QUERY","name": "top"}
                },
                {
                  "ablName": "ttTalk",
                  "ablType": "TABLE",
                  "ioMode": "OUTPUT",
                  "msgElem": {"type": "FIELD","name": "data"}
                },
                {
                  "ablName": "pCount",
                  "ablType": "INTEGER",
                  "ioMode": "OUTPUT",
                  "msgElem": {"type": "FIELD","name": "count"}
                }
              ]
            }
          },
          "POST": {
            "contentType": "application/vnd.conf.talks+json",
            "statusCode": 201,
            "entity": {
              "type": "procedure",
              "name": "logic/talk/new_talk.p",
              "function": "create_talk",
              "arg": [
                {
                  "ablName": "pStream",
                  "ablType": "CHARACTER",
                  "ioMode": "INPUT",
                  "msgElem": {
                    "type": "FIELD",
                    "name": "stream"
                  }
                },
                {
                  "ablName": "pName",
                  "ablType": "CHARACTER",
                  "ioMode": "INPUT",
                  "msgElem": {
                    "type": "FIELD",
                    "name": "name"
                  }
                },
                {
                  "ablName": "pId",
                  "ablType": "CHARACTER",
                  "ioMode": "OUTPUT",
                  "msgElem": {
                    "type": "HEADER",
                    "name": "Location"
                  }
                }
              ]
            }
          }
        },
        "/talk({tlk})": {
          "GET": {
            "contentType": "application/vnd.conf.talks+json",
            "statusCode": 200,
            "entity": {
              "type": "procedure",
              "name": "logic/talk/read_talks.p",
              "function": "get_single_talk",
              "arg": [
                {
                  "ablName": "pId",
                  "ablType": "CHARACTER",
                  "ioMode": "INPUT",
                  "msgElem": {
                    "type": "PATH",
                    "name": "tlk"
                  }
                },
                {
                  "ablName": "ttTalk",
                  "ablType": "TABLE",
                  "ioMode": "OUTPUT",
                  "msgElem": {
                    "type": "FIELD",
                    "name": "data"
                  }
                }
              ]
            }
          }
        },
        "/talks": {
          "GET": {
            "contentType": "application/vnd.conf.talks+json",
            "statusCode": 200,
            "entity": {
              "type": "procedure",
              "name": "logic/talk/read_talks.p",
              "function": "read_param_filter",
              "arg": [
                {
                  "ablName": "pParams",
                  "ablType": "CLASS logic.FilterParams",
                  "ioMode": "INPUT",
                  "msgElem": [
                        {"type": "QUERY", "name": "$filter",    "ablRef":"Where"},
                        {"type": "QUERY", "name": "$top",       "ablRef":"TopRecs"},
                        {"type": "QUERY", "name": "$skip",      "ablRef":"SkipRecs"},
                        {"type": "QUERY", "name": "$sortby",    "ablRef":"SortBy"}
                  ]
                },
                {
                  "ablName": "ttTalk",
                  "ablType": "TABLE",
                  "ioMode": "OUTPUT",
                  "msgElem": {"type": "FIELD","name": "data"}
                },
                {
                  "ablName": "pCount",
                  "ablType": "INTEGER",
                  "ioMode": "OUTPUT",
                  "msgElem": {"type": "FIELD","name": "count"}
                }
              ]
            }
          }
        },
        "/talks/resp": {
          "GET": {
            "contentType": "application/vnd.conf.talks+json",
            "statusCode": 200,
            "entity": {
              "type": "procedure",
              "name": "logic/talk/read_talks.p",
              "function": "read_param_filter_response",
              "arg": [
                {
                  "ablName": "pParams",
                  "ablType": "CLASS logic.FilterParams",
                  "ioMode": "INPUT",
                  "msgElem": [
                        {"type": "QUERY", "name": "$filter", "ablRef":"Where"},
                        {"type": "QUERY", "name": "$top",    "ablRef":"TopRecs"},
                        {"type": "QUERY", "name": "$skip",   "ablRef":"SkipRecs"},
                        {"type": "QUERY", "name": "$sortby", "ablRef":"SortBy"}
                  ]
                },
                {
                  "ablName": "ttTalk",
                  "ablType": "TABLE",
                  "ioMode": "OUTPUT",
                  "msgElem": {"type": "FIELD","name": "data"}
                },
                {
                  "ablName": "pResp",
                  "ablType": "CLASS logic.FilterResponse",
                  "ioMode": "OUTPUT",
                  "msgElem": [
                    {"type": "FIELD", "name": "count", "ablRef": "NumRecs"},
                    {"type": "FIELD", "name": "isEnd", "ablRef": "IsLastBatch"}
                  ]
                }
              ]
            }
          }
        },        
        "/{tlk}": {
          "GET": {
            "contentType": "application/vnd.conf.talks+json",
            "statusCode": 200,
            "entity": {
              "type": "procedure",
              "name": "logic/talk/read_talks.p",
              "function": "get_single_talk",
              "arg": [
                {
                  "ablName": "pId",
                  "ablType": "CHARACTER",
                  "ioMode": "INPUT",
                  "msgElem": {
                    "type": "PATH",
                    "name": "tlk"
                  }
                },
                {
                  "ablName": "ttTalk",
                  "ablType": "TABLE",
                  "ioMode": "OUTPUT",
                  "msgElem": {
                    "type": "FIELD",
                    "name": "data"
                  }
                }
              ]
            }
          },
          "PUT": {
            "contentType": "application/vnd.conf.talks+json",
            "statusCode": 200,
            "entity": {
              "type": "procedure",
              "name": "logic/talk/update_talk.p",
              "function": "update_talks",
              "arg": [
                {
                  "ablName": "ttTalk",
                  "ablType": "TABLE",
                  "ioMode": "INPUT-OUTPUT",
                  "msgElem": [
                    {
                      "type": "BODY",
                      "name": null
                    }
                  ]
                }
              ]
            }
          }
        }
      },
      "schemas": {
        "dsTalk": {
          "ttTalk": {
            "trackChanges": true,
            "serializeName": "talks",
            "indexes": {
              "idx1": {
                "fields": [
                  "id"
                ],
                "primary": true,
                "unique": true,
                "word": false
              },
              "idx2": {
                "fields": [
                  "speaker"
                ],
                "primary": false,
                "unique": false,
                "word": false
              },
              "idx3": {
                "fields": [
                  "talk_status"
                ],
                "primary": false,
                "unique": false,
                "word": false
              }
            },
            "fields": [
              {
                "name": "id",
                "ablType": "CHARACTER",
                "extent": null
              },
              {
                "name": "name",
                "ablType": "CHARACTER",
                "extent": null
              },
              {
                "name": "speaker",
                "ablType": "CHARACTER",
                "extent": null
              },
              {
                "name": "abstract",
                "ablType": "CHARACTER",
                "extent": null
              },
              {
                "name": "talk_status",
                "ablType": "Progress.Lang.Object",
                "extent": null,
                "serializeName": "currentStatus"
              },
              {
                "name": "content_url",
                "ablType": "Progress.Lang.Object",
                "extent": null,
                "serializeName": "content"
              },
              {
                "name": "content_type",
                "ablType": "CHARACTER",
                "extent": null,
                "serializeHidden": true
              }
            ]
          },
          "ttSpeaker": {
            "trackChanges": true,
            "serializeName": "speakers",
            "indexes": {
              "idx1": {
                "fields": [
                  "id"
                ],
                "primary": true,
                "unique": true,
                "word": false
              },
              "idx2": {
                "fields": [
                  "name"
                ],
                "primary": false,
                "unique": false,
                "word": false
              }
            },
            "fields": [
              {
                "name": "id",
                "ablType": "CHARACTER",
                "extent": null
              },
              {
                "name": "name",
                "ablType": "CHARACTER",
                "extent": null
              },
              {
                "name": "bio",
                "ablType": "CHARACTER",
                "extent": null
              },
              {
                "name": "photo",
                "ablType": "BLOB",
                "extent": null
              },
              {
                "name": "url",
                "ablType": "CHARACTER",
                "extent": null
              }
            ]
          },
          "ttTimeslot": {
            "trackChanges": true,
            "serializeName": "timeslots",
            "indexes": {
              "idx1": {
                "fields": [
                  "id"
                ],
                "primary": true,
                "unique": true,
                "word": false
              },
              "idx2": {
                "fields": [
                  "room",
                  "start_at"
                ],
                "primary": false,
                "unique": true,
                "word": false
              },
              "idx3": {
                "fields": [
                  "talk"
                ],
                "primary": false,
                "unique": false,
                "word": false
              }
            },
            "fields": [
              {
                "name": "id",
                "ablType": "CHARACTER",
                "extent": null
              },
              {
                "name": "talk",
                "ablType": "CHARACTER",
                "extent": null
              },
              {
                "name": "room",
                "ablType": "CHARACTER",
                "extent": null
              },
              {
                "name": "start_at",
                "ablType": "DATETIME-TZ",
                "extent": null,
                "serializeName": "startAt"
              },
              {
                "name": "duration",
                "ablType": "INTEGER",
                "extent": null
              }
            ]
          }
        }
      }
    }
  }
}